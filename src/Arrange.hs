{-# LANGUAGE OverloadedStrings #-}

module Arrange where

import Data.Map as Map
import Data.Text
import Text.Megaparsec
import Text.Megaparsec.Char.Lexer

textToAim :: Text -> Either Text Aim
textToAim x =
  case parseMaybe intParser x of
    Nothing -> Left "数字を入力してください"
    Just number -> case Map.lookup number arrange of
      Nothing -> Left "非対応の数字です"
      Just aim -> Right aim

intParser :: Parsec Text Text Int
intParser = do
  int <- decimal
  eof
  return int

type Arrange = Map Int Aim

data Aim = Aim
  { aim :: Text,
    comment :: Text
  }

arrange :: Arrange
arrange =
  fromList
    ( [ (2, Aim "D1" "Mad House とも呼ばれます。"),
        (3, Aim "S1 -> D1" "略"),
        (4, Aim "D2" "略"),
        (5, Aim "S1 -> D2" "略"),
        (6, Aim "D3" "略"),
        (7, Aim "S3 -> D2" "略"),
        (8, Aim "D4" "略"),
        (9, Aim "S1 -> D4" "略"),
        (10, Aim "D5" "略"),
        (11, Aim "S3 -> D4" "略"),
        (12, Aim "D6" "略"),
        (13, Aim "S5 -> D4" "略"),
        (14, Aim "D7" "略"),
        (15, Aim "S7 -> D4" "略"),
        (16, Aim "D8" "略"),
        (17, Aim "S1 -> D8" "略"),
        (18, Aim "D9" "略"),
        (19, Aim "S3 -> D8" "略"),
        (20, Aim "D10" "略"),
        (21, Aim "S5 -> D8" "略"),
        (22, Aim "D11" "略"),
        (23, Aim "S7 -> D8" "略"),
        (24, Aim "D12" "略"),
        (25, Aim "S9 -> D12" "略"),
        (26, Aim "D13" "略"),
        (27, Aim "S11 -> D8" "略"),
        (28, Aim "D14" "略"),
        (29, Aim "S13 -> D8" "略"),
        (30, Aim "D15" "略"),
        (31, Aim "S15 -> D8" "略"),
        (32, Aim "D16" "略"),
        (33, Aim "S1 -> D16" "略"),
        (34, Aim "D17" "略"),
        (35, Aim "S3 -> D16" "略"),
        (36, Aim "D18" "略"),
        (37, Aim "S5 -> D16" "略"),
        (38, Aim "D16" "略"),
        (39, Aim "S7 -> D16" "略"),
        (40, Aim "D20" "略"),
        (41, Aim "S9 -> D16" "略"),
        (42, Aim "S10 -> D16" "S6 -> D18 というルートもあるため、6 と 10 を同時狙いできます。"),
        (43, Aim "S3 -> D20" "S19 -> D12 というルートもあるため、3 と 19 を同時狙いできます。"),
        (44, Aim "S12 -> D16" "8 と 16 を同時狙いしてもいいかもしれません。"),
        (45, Aim "S13 -> D16" "略"),
        (46, Aim "S6 -> D20" "S10 -> D18 というルートもあるため、6 と 10 を同時狙いできます。"),
        (47, Aim "S7 -> D20" "S19 -> D14 というルートもあるため、7 と 19 を同時狙いできます。"),
        (48, Aim "S16 -> D16" "S8 -> D20 というルートもあるため、8 と 16 を同時狙いできます。"),
        (49, Aim "S17 -> D16" "トリプルに入ると bust するため、S9 のほうが安全かもしれません。"),
        (50, Aim "S18 -> D16" "トリプルに入ると bust するため、S10 のほうが安全かもしれません。"),
        (51, Aim "S19 -> D16" "トリプルに入ると bust するため、S11 のほうが安全かもしれません。"),
        (52, Aim "S12 -> D20" "トリプルに入ると D8 残りです。"),
        (53, Aim "S13 -> D20" "略"),
        (54, Aim "S14 -> D20" "トリプルに入ると D6 残りです。"),
        (55, Aim "S15 -> D20" "略"),
        (56, Aim "S16 -> D20" "トリプルに入ると D4 残りです。"),
        (57, Aim "S17 -> D20" "略"),
        (58, Aim "S18 -> D20" "略"),
        (59, Aim "S19 -> D20" "トリプルに入ると bust するため、S9 のほうが安全かもしれません。"),
        (60, Aim "S20 -> D20" "略"),
        (61, Aim "T15 -> D8" "S15 にはずしても、6 と 10 を同時狙いできる 46 が残ります。"),
        (62, Aim "T10 -> D16" "S10 にはずすと 52 残りです。"),
        (63, Aim "T13 -> D12" "S13 にはずすと 50 残りです。"),
        (64, Aim "T16 -> D8" "S16 にはずすと 48 残りです。"),
        (65, Aim "T11 -> D16\n25 -> D20" "S11 にはずすと 54 残りです。"),
        (66, Aim "T14 -> D12" "S14 にはずすと 52 残りです。"),
        (67, Aim "T17 -> D8" "S17 にはずすと 50 残りです。"),
        (68, Aim "T20 -> D8" "S20 にはずすと 48 残りです。"),
        (69, Aim "T15 -> D12" "S15 にはずすと 54 残りです。"),
        (70, Aim "T18 -> D8" "S18 にはずすと 52 残りです。"),
        (71, Aim "T13 -> D16" "S13 にはずすと 58 残りです。"),
        (72, Aim "T16 -> D12" "S16 にはずすと 56 残りです。"),
        (73, Aim "T19 -> D8" "S19 にはずすと 54 残りです。"),
        (74, Aim "T14 -> D16" "S14 にはずすと 60 残りです。"),
        (75, Aim "T17 -> D12" "S17 にはずすと 58 残りです。"),
        (76, Aim "T20 -> D8" "S20 にはずすと 56 残りです。"),
        (77, Aim "T19 -> D10" "S19 にはずすと 58 残りです。"),
        (78, Aim "T18 -> D12" "S18 にはずすと 60 残りです。"),
        (79, Aim "T19 -> D11" "シングル 2 本でダブルを出すには、19 を狙う必要があります。\nS19 にはずすと 60 残りです。"),
        (80, Aim "T20 -> D10" "S20 にはずすと 60 残りです。"),
        (81, Aim "T19 -> D12" "S19 にはずすと 62 残りです。"),
        (82, Aim "Bull -> D16" "25 にはずすと 57 残りです。"),
        (83, Aim "T17 -> D16" "S17 にはずすと 66 残りです。"),
        (84, Aim "T20 -> D12" "S20 にはずすと 64 残りです。"),
        (85, Aim "T15 -> D20" "S15 にはずすと 70 残りです。"),
        (86, Aim "T18 -> D16" "S18 にはずすと 68 残りです。"),
        (87, Aim "T17 -> D18" "S17 にはずすと 70 残りです。"),
        (88, Aim "T20 -> D14" "S20 にはずすと 68 残りです。"),
        (90, Aim "T20 -> D15\nBull -> D20" "T18 -> D18 というルートもありますが、S18 にはずすと 72 が残り、シングルでダブルが出せません。"),
        (91, Aim "T17 -> D20" "S17 にはずすと 74 残りです。"),
        (92, Aim "T20 -> D16" "S20 にはずすと 72 残りです。"),
        (93, Aim "T19 -> D18" "S19 にはずすと 74 残りです。"),
        (94, Aim "T18 -> D20" "S18 にはずすと 76 残りです。"),
        (95, Aim "T19 -> D19" "S19 にはずすと 76 残りです。"),
        (96, Aim "T20 -> D18" "S20 にはずすと 76 残りです。"),
        (97, Aim "T19 -> D20" "S19 にはずすと 78 残りです。"),
        (98, Aim "T20 -> D19" "S20 にはずすと 78 残りです。"),
        (99, Aim "T19 -> S10 -> D16" "トリプル 1 本ではダブルを出せません。"),
        (100, Aim "T20 -> D20" "略"),
        (101, Aim "T20 -> S9 -> D16" "S1 や S5 にずれてもチャンスは残ります。相手に上がり目がないのなら、S19 -> 25 -> S17 や、25 -> S20 -> S16 のように次のラウンドにダブルを残すのもありです。"),
        (102, Aim "T20 -> S10 -> D16" "S20 にはずすと 82 が残ります。相手に上がり目があるのなら、Bull より大きい T14 を狙うのが良いでしょう。"),
        (103, Aim "T19 -> S6 -> D20" "左右にずれてもチャンスが残る 19 を狙うと良いでしょう。S19 にはずすと 84 残りです。"),
        (104, Aim "T19 -> S7 -> D20" "左右にずれてもチャンスが残る 19 を狙うと良いでしょう。S19 にはずすと85 残りです。"),
        (105, Aim "T20 -> S13 -> D16" "左右にずれてもチャンスは残ります。S20 にはずすと 85 残り。"),
        (106, Aim "T20 -> S6 -> D20" "S20 にはずすと 86 残りです。"),
        (107, Aim "T19 -> S18 -> D16" "左右にずれてもチャンスが残る 19 を狙うと良いでしょう。S19 にはずすと 88 残りです。"),
        (108, Aim "T20 -> S16 -> D16" "S20 にはずすと 88 残りです。"),
        (109, Aim "T20 -> S17 -> D16" "S20 にはずすと 89 残りです。"),
        (110, Aim "T20 -> S18 -> D16" "S20 にはずすと 90 残りです。"),
        (111, Aim "T20 -> S19 -> D16" "S20 にはずすと 91 残りです。"),
        (112, Aim "T20 -> S12 -> D20" "S20 にはずすと 92 残りです。"),
        (113, Aim "T20 -> S13 -> D20" "S20 にはずすと 93 残りです。"),
        (114, Aim "T20 -> S14 -> D20" "S20 にはずすと 94 残りです。"),
        (115, Aim "T19 -> S18 -> D20" "S19 にはずすと 96 残りです。"),
        (116, Aim "T20 -> S16 -> D20" "S20 にはずすと 96 残りです。"),
        (117, Aim "T20 -> S17 -> D20" "S20 にはずすと 97 残りです。"),
        (118, Aim "T20 -> S18 -> D20" "18 から狙いたくなりますが、T18 に入った場合 64 が残りシングルでは Bull 以外のダブルが出せません。S20 にはずすと 98 残りです。"),
        (119, Aim "T19 -> T12 -> D13" "T20 を狙ってシングルにはずすと 99 が残り、2 本であがれません。S19 にはずすと 100 残りです。"),
        (120, Aim "T20 -> S20 -> D20" "S20 にはずすと 100 残りです。"),
        (121, Aim "T20 -> T11 -> D14\nT20 -> S11 -> Bull\nS20 -> T17 -> Bull" "シングルにはずれてもいいように 20 から狙います。"),
        (122, Aim "T18 -> T18 -> D7\nT18 -> S18 -> Bull\nS18 -> T18 -> Bull" "シングルにはずれてもいいように 18 から狙います。"),
        (123, Aim "T19 -> T16 -> D9\nT19 -> S16 -> Bull\nS19 -> T18 -> Bull" "シングルにはずれてもいいように 19 から狙います。"),
        (124, Aim "T20 -> T14 -> D11\nT20 -> S14 -> Bull\nS20 -> T18 -> Bull" "シングルにはずれてもいいように 20 から狙います。"),
        (125, Aim "Bull -> 25 -> Bull\n25 -> T20 -> D20" "1 本持ちでも Bull を狙うことがよくあります。"),
        (126, Aim "T19 -> T19 -> D6\nT19 -> S19 -> Bull\nS19 -> T19 -> Bull" "シングルにはずれてもいいように 19 から狙います。"),
        (127, Aim "T20 -> T17 -> D8\nT20 -> S17 -> Bull\nS20 -> T19 -> Bull" "シングルにはずれてもいいように 20 から狙います。"),
        (128, Aim "T18 -> T18 -> D10\nS18 -> T20 -> Bull" "シングルにはずれてもいいように 18 から狙います。1 本目に T18 に入った場合 74 が残ります。T14 -> D16 でもいいですが、1 本目と同じ場所を狙うほうがダブルを残せる可能性が高いため、T18 -> D10 としています。"),
        (129, Aim "T19 -> T16 -> D12\nS19 -> T20 -> Bull" "シングルにはずれてもいいように 19 から狙います。"),
        (130, Aim "T20 -> T20 -> D5\nT20 -> S20 -> Bull\nS20 -> T20 -> Bull" "シングルにはずれてもいいように 20 から狙います。"),
        (131, Aim "T20 -> T13 -> D16" "略"),
        (132, Aim "Bull -> Bull -> D16\n25 -> T19 -> Bull" "略"),
        (133, Aim "T20 -> T19 -> D8" "略"),
        (134, Aim "T20 -> T14 -> D16" "略"),
        (135, Aim "Bull -> T15 -> D20\n25 -> T20 -> Bull" "チャンスが増えるように Bull から狙います。"),
        (136, Aim "T20 -> T20 -> D8" "略"),
        (137, Aim "T20 -> T19 -> D10" "略"),
        (138, Aim "T20 -> T18 -> D12" "略"),
        (139, Aim "T19 -> T14 -> D20" "略"),
        (140, Aim "T20 -> T20 -> D10" "まずは 20 から削りましょう。"),
        (141, Aim "T20 -> T19 -> D12" "まずは 20 から削りましょう。"),
        (142, Aim "T20 -> T14 -> D20" "まずは 20 から削りましょう。"),
        (143, Aim "T20 -> T17 -> D16" "まずは 20 から削りましょう。"),
        (144, Aim "T20 -> T20 -> D12" "まずは 20 から削りましょう。"),
        (145, Aim "T20 -> T15 -> D20" "まずは 20 から削りましょう。"),
        (146, Aim "T20 -> T18 -> D16" "まずは 20 から削りましょう。"),
        (147, Aim "T20 -> T17 -> D18" "まずは 20 から削りましょう。"),
        (148, Aim "T20 -> T20 -> D14" "まずは 20 から削りましょう。"),
        (149, Aim "T20 -> T19 -> D16" "まずは 20 から削りましょう。"),
        (150, Aim "T20 -> T18 -> D18" "まずは 20 から削りましょう。"),
        (151, Aim "T20 -> T17 -> D20" "まずは 20 から削りましょう。"),
        (152, Aim "T20 -> T20 -> D16" "まずは 20 から削りましょう。"),
        (153, Aim "T20 -> T19 -> D18" "まずは 20 から削りましょう。"),
        (154, Aim "T20 -> T18 -> D20" "まずは 20 から削りましょう。"),
        (155, Aim "T20 -> T19 -> D19" "まずは 20 から削りましょう。"),
        (156, Aim "T20 -> T20 -> D18" "まずは 20 から削りましょう。"),
        (157, Aim "T20 -> T19 -> D20" "まずは 20 から削りましょう。"),
        (158, Aim "T20 -> T20 -> D19" "まずは 20 から削りましょう。"),
        (159, Aim "-" "3 本ではあがれません。"),
        (160, Aim "T20 -> T20 -> D20" "まずは 20 から削りましょう。"),
        (161, Aim "T20 -> T17 -> Bull" "略"),
        (162, Aim "-" "3 本ではあがれません。"),
        (163, Aim "-" "3 本ではあがれません。"),
        (164, Aim "T20 -> T18 -> Bull" "略"),
        (165, Aim "-" "3 本ではあがれません。"),
        (166, Aim "-" "3 本ではあがれません。"),
        (167, Aim "T20 -> T19 -> Bull" "略"),
        (168, Aim "-" "3 本ではあがれません。"),
        (169, Aim "-" "3 本ではあがれません。"),
        (170, Aim "T20 -> T20 -> Bull" "略")
      ]
        ++ Prelude.map (,Aim "20" "まずは 20 で削りましょう") [171 .. 220]
        ++ [ (221, Aim "20" "20 を 3 本であがり目を残せます。"),
             (222, Aim "S20 -> S20 -> S18" "20 キープではあがり目が残せません。"),
             (223, Aim "S20 -> S20 -> S19" "20 キープではあがり目が残せません。"),
             (224, Aim "20" "20 を 3 本であがり目を残せます。"),
             (225, Aim "S20 -> S20 -> S18\nS20 -> S20 -> 25" "20 キープではあがり目が残せません。"),
             (226, Aim "S20 -> S20 -> S19" "20 キープではあがり目が残せません。"),
             (227, Aim "20" "20 を 3 本であがり目を残せます。"),
             (228, Aim "S20 -> S20 -> S18" "20 キープではあがり目が残せません。"),
             (229, Aim "S20 -> S20 -> S19" "20 キープではあがり目が残せません。"),
             (230, Aim "20" "20 を 3 本であがり目を残せます。"),
             (231, Aim "S20 -> S19 -> 25" "シングル 3 本ではあがり目が出せないため Bull を使う必要があり、そのために 19 にスイッチします。1 本目にトリプルに入った場合は 19 にスイッチする必要はありません。"),
             (232, Aim "S20 -> S20 -> 25" "シングル 3 本ではあがり目が出せないため Bull を使う必要があります。"),
             (233, Aim "S19 -> S19 -> 25" "シングル 3 本ではあがり目が出せないため Bull を使う必要があり、そのために 19 から狙います。"),
             (234, Aim "S20 -> S19 -> 25" "シングル 3 本ではあがり目が出せないため Bull を使う必要があり、そのために 19 にスイッチします。1 本目にトリプルに入った場合は 19 にスイッチする必要はありません。"),
             (235, Aim "S20 -> S20 -> 25" "シングル 3 本ではあがり目が出せないため Bull を使う必要があります。")
           ]
        ++ Prelude.map (,Aim "20" "20 キープでは上がり目が出せません。") [236 .. 258]
        ++ [ (259, Aim "T20 -> S20 -> S19\nS20 -> S19 -> T20\nS20 -> T19 -> S18" "100 点削るとあがり目のない 159 が残ってしまうため、19 を使う必要があります。19 を 5 本入れるのが覚えやすいですが、164 点という難易度の高い数字が残ります。20 から狙えば 160 等のよりあがりやすい数字が残せる可能性が高くなります。"),
             (260, Aim "20" "100 点削ればあがり目が残せます。"),
             (261, Aim "20" "100 点削ればあがり目が残せます。"),
             (262, Aim "T20 -> S20 -> S18\nS20 -> T18 -> S18\nS20 -> S18 -> T18" "100 点削るとあがり目が出せないため、18 を使う必要があります。"),
             (263, Aim "T20 -> S20 -> S19\nS20 -> T19 -> S19\nS20 -> S19 -> T19" "100 点削るとあがり目が出せないため、19 を使う必要があります。"),
             (264, Aim "20" "100 点削ればあがり目が残せます。"),
             (265, Aim "19 を 5 本" "100 点削るとあがり目が出せないため、19 を使う必要があります。"),
             (266, Aim "T20 -> S20 -> S19\nS20 -> T19 -> S19\nS20 -> S19 -> T19" "100 点削るとあがり目が出せないため、19 を使う必要があります。"),
             (267, Aim "20" "100 点削ればあがり目が残せます。"),
             (268, Aim "S19 -> S19 -> T20\nS19 -> T19 -> 25" "100 点削るとあがり目が出せないため、19 を使う必要があります。S20 -> S18 -> T20 でも良さそうですが、2 本目がトリプルに入ると 194 残りとなり、もう 1 本トリプルが必要になってしまいます。"),
             (269, Aim "T20 -> S20 -> S19\nS20 -> T19 -> 25\nS20 -> S19 -> T20" "100 点削るとあがり目が出せないため、19 を使う必要があります。"),
             (270, Aim "20" "100 点削ればあがり目が残せます。"),
             (271, Aim "19 を 4 本 -> 25" "100 点では足りないため Bull を使う必要があり、数字の調整のために 19 から狙います。"),
             (272, Aim "20 を 4 本 -> 25" "100 点では足りないため Bull を使う必要があります。"),
             (273, Aim "T20 -> S18 -> 25" "100 点では足りないため Bull を使う必要があります。1 本目がシングルだった場合は残り 2 本ともトリプルに入れる必要があります。"),
             (274, Aim "T20 -> S19 -> 25" "100 点では足りないため Bull を使う必要があります。1 本目がシングルだった場合は残り 2 本ともトリプルに入れる必要があります。"),
             (275, Aim "20 を 4 本 -> 25" "100 点では足りないため Bull を使う必要があります。")
           ]
        ++ Prelude.map (,Aim "20" "140 点削ればあがり目が残せます。") [276 .. 298]
        ++ [ (299, Aim "T19 -> T18 -> S18\nS19 -> T20 -> T20" "140 点削るとあがり目が出せないため、19 から狙います。"),
             (300, Aim "20" " 140 点削ればあがり目が残せます 。"),
             (301, Aim "20" " 140 点削ればあがり目が残せます 。"),
             (302, Aim "T18 -> S18 -> T20\nS18 -> T18 -> T20" "140 点削るとあがり目が出せないため、18 を使う必要があります。"),
             (303, Aim "19 を 7 本" "140 点削るとあがり目が出せないため、19 を使う必要があります。"),
             (304, Aim "20" "140 点削ればあがり目が残せます。"),
             (305, Aim "T20 -> T20 -> 25" "140 点削るとあがり目が出せないため、Bull を使う必要があります。1 本目をシングルにはずすとあがり目が出せません。"),
             (306, Aim "T19 -> T19 -> 25\nT19 -> S19 -> T20\nS19 -> T19 -> T20" "140 点削るとあがり目が出せないため、19 を使う必要があります。"),
             (307, Aim "20" "140 点削ればあがり目が残せます。"),
             (308, Aim "S18 -> T20 -> T20" "140 点削ればあがり目が出せないため、18 を使う必要があります。T18 に入ったとしても、残りの 2 本ともトリプルが必要です。"),
             (309, Aim "T19 -> T19 -> 25\nS19 -> T20 -> T20" "140 点削ればあがり目が出せないため、19 を使う必要があります。T19 -> S19 となった場合はあがり目が出せません。"),
             (310, Aim "20" "140 点削ればあがり目が残せます。"),
             (311, Aim "20" "180 点が必要です。"),
             (312, Aim "T20 -> T20 -> 25" "140 点では足りないため Bull を使うアレンジです。"),
             (313, Aim "20" "180 点が必要です。"),
             (314, Aim "20" "180 点が必要です。"),
             (315, Aim "T20 -> T20 -> 25" "140 点では足りないため Bull を使うアレンジです。")
           ]
    )
